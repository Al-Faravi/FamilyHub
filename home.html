<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Hub | Digital Home</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #10b981;
            --accent: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --light: #f8fafc;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--light); color: var(--dark); overflow-x: hidden; }

        /* Navigation */
        nav {
            padding: 20px 10%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: 0.4s;
        }
        nav.scrolled {
            background: white;
            padding: 12px 10%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .nav-links { list-style: none; display: flex; gap: 30px; align-items: center; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; transition: 0.3s; }
        .nav-links a:hover { color: var(--primary); }
        .btn-portal { background: var(--primary); color: white !important; padding: 10px 20px; border-radius: 8px; }

        /* Hero Section */
        .hero {
            height: 90vh;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            display: flex;
            align-items: center;
            padding: 0 10%;
        }
        .hero-content { max-width: 700px; }
        .greeting { color: var(--primary); font-weight: 600; font-size: 1.2rem; margin-bottom: 10px; display: block; }
        .hero-content h1 { font-size: 3.5rem; line-height: 1.2; margin-bottom: 20px; }
        .cta-buttons { display: flex; gap: 15px; }
        .btn { padding: 15px 30px; border-radius: 10px; text-decoration: none; font-weight: 600; transition: 0.3s; cursor: pointer; border: none; }
        .btn-main { background: var(--primary); color: white; }
        .btn-outline { border: 2px solid var(--primary); color: var(--primary); background: transparent; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(79, 70, 229, 0.2); }

        /* Birthday Highlight Bar */
        .birthday-bar {
            background: var(--accent);
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: 600;
            display: none; /* Hidden by default */
        }

        /* Stats Section */
        .stats-banner {
            margin-top: -60px;
            padding: 0 10%;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .stat-item {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 15px 30px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .stat-item i { font-size: 2rem; color: var(--secondary); margin-bottom: 10px; }
        .stat-item h2 { font-size: 2.5rem; margin-bottom: 5px; }

        /* Dynamic Notice Board */
        .section-padding { padding: 80px 10%; }
        .section-header { text-align: center; margin-bottom: 50px; }
        .notice-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .notice-card { background: white; padding: 25px; border-radius: 15px; border-left: 5px solid var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .notice-card.urgent { border-left-color: var(--danger); }
        .notice-date { font-size: 0.8rem; color: #94a3b8; }

        /* Gallery Section */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        .gallery-item {
            height: 250px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .gallery-item:hover img { transform: scale(1.1); }
        .gallery-overlay {
            position: absolute; bottom: 0; left: 0; width: 100%; padding: 15px;
            background: linear-gradient(transparent, rgba(0,0,0,0.7)); color: white;
        }

        /* Footer */
        footer { background: var(--dark); color: white; padding: 60px 10%; text-align: center; }
        
        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.2rem; }
            .nav-links { display: none; }
        }
    </style>
</head>
<body>

<div id="bday-announcer" class="birthday-bar">
    <i class="fas fa-cake-candles"></i> Today is <span id="bday-name">...</span>'s Birthday! üéÇ
</div>

<nav id="navbar">
    <div class="logo"><i class="fas fa-house-chimney"></i> FamilyHub</div>
    <ul class="nav-links">
        <li><a href="#">Home</a></li>
        <li><a href="#notices">Notices</a></li>
        <li><a href="#gallery">Memories</a></li>
        <li><a href="index.html" class="btn-portal">Directory</a></li>
    </ul>
</nav>

<section class="hero">
    <div class="hero-content">
        <span class="greeting" id="time-greeting">Hello!</span>
        <h1>Your Family's Digital Home & Network.</h1>
        <p>Stay connected with cousins, find blood donors instantly, and never miss a family announcement again.</p>
        <div class="cta-buttons">
            <a href="index.html" class="btn btn-main"><i class="fas fa-search"></i> Search Directory</a>
            <button onclick="window.print()" class="btn btn-outline"><i class="fas fa-print"></i> Print List</button>
        </div>
    </div>
</section>

<div class="stats-banner">
    <div class="stat-item">
        <i class="fas fa-users"></i>
        <h2 id="total-members">0</h2>
        <p>Total Cousins</p>
    </div>
    <div class="stat-item" style="border-bottom: 4px solid var(--danger);">
        <i class="fas fa-droplet" style="color: var(--danger);"></i>
        <h2 id="blood-donors">0</h2>
        <p>Blood Donors</p>
    </div>
    <div class="stat-item">
        <i class="fas fa-calendar-day"></i>
        <h2 id="upcoming-events">3</h2>
        <p>Active Notices</p>
    </div>
</div>

<section id="notices" class="section-padding">
    <div class="section-header">
        <h2><i class="fas fa-bullhorn"></i> Family Notice Board</h2>
        <p>Latest updates and announcements from the family elders</p>
    </div>
    <div id="notice-container" class="notice-grid">
        <div class="notice-card">
            <span class="notice-date">Loading notices...</span>
        </div>
    </div>
</section>

<section id="gallery" class="section-padding" style="background: #f1f5f9;">
    <div class="section-header">
        <h2><i class="fas fa-images"></i> Family Memories</h2>
        <p>Capturing our best moments together</p>
    </div>
    <div class="gallery-grid">
        <div class="gallery-item">
            <div class="gallery-overlay">Family Picnic 2023</div>
        </div>
        <div class="gallery-item">
            <div class="gallery-overlay">Cousins Meetup</div>
        </div>
        <div class="gallery-item">
            <div class="gallery-overlay">Eid Celebration</div>
        </div>
    </div>
</section>

<footer>
    <p>&copy; 2024 FamilyHub | Organized with ‚ù§Ô∏è by the Cousins</p>
</footer>

<script>
    // ‡ßß. ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶®
    function animateCounter(id, target) {
        let current = 0;
        let increment = Math.ceil(target / 50) || 1;
        let timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                current = target;
                clearInterval(timer);
            }
            document.getElementById(id).innerText = current;
        }, 30);
    }

    // ‡ß®. ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶®‡¶æ
    async function loadDashboardData() {
        try {
            const res = await fetch('http://localhost:5000/api/students');
            const members = await res.json();

            // ‡¶è‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ
            animateCounter('total-members', members.length);
            const donors = members.filter(m => m.blood_group).length;
            animateCounter('blood-donors', donors);

            // ‡ß©. ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
            checkBirthdays(members);

            // ‡ß™. ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶§‡ßà‡¶∞‡¶ø (Sample Data)
            renderNotices();

        } catch (error) {
            console.error("Fetch Error:", error);
            document.getElementById('total-members').innerText = "!";
        }
    }

    // ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï
    function checkBirthdays(members) {
        const today = new Date();
        const todayStr = `${today.getMonth() + 1}-${today.getDate()}`; // format: M-D
        
        // ‡¶ß‡¶∞‡ßÅ‡¶® ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú‡ßá dob ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶Ü‡¶õ‡ßá 'YYYY-MM-DD' ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá
        const bdayBoy = members.find(m => {
            if(!m.dob) return false;
            const d = new Date(m.dob);
            return `${d.getMonth() + 1}-${d.getDate()}` === todayStr;
        });

        if (bdayBoy) {
            document.getElementById('bday-announcer').style.display = 'block';
            document.getElementById('bday-name').innerText = bdayBoy.name;
        }
    }

    // ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ
    function renderNotices() {
        const container = document.getElementById('notice-container');
        const notices = [
            { title: "Grand Picnic 2024", body: "Our annual picnic is scheduled for December 25th.", date: "2 days ago", type: "normal" },
            { title: "Emergency: O+ Blood Needed", body: "Urgent blood requirement for a relative in Dhaka.", date: "1 hour ago", type: "urgent" },
            { title: "New Feature Added", body: "You can now print the family directory directly from home.", date: "Just now", type: "normal" }
        ];

        container.innerHTML = notices.map(n => `
            <div class="notice-card ${n.type === 'urgent' ? 'urgent' : ''}">
                <span class="notice-date">${n.date}</span>
                <h3>${n.title}</h3>
                <p>${n.body}</p>
            </div>
        `).join('');
    }

    // ‡ß´. ‡¶ó‡ßç‡¶∞‡¶ø‡¶ü‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶á‡¶´‡ßá‡¶ï‡ßç‡¶ü
    window.addEventListener('scroll', () => {
        const nav = document.getElementById('navbar');
        window.scrollY > 50 ? nav.classList.add('scrolled') : nav.classList.remove('scrolled');
    });

    function setGreeting() {
        const hour = new Date().getHours();
        const el = document.getElementById('time-greeting');
        if (hour < 12) el.innerText = "‚òÄÔ∏è Good Morning, Family!";
        else if (hour < 18) el.innerText = "üå§Ô∏è Good Afternoon!";
        else el.innerText = "üåô Good Evening!";
    }

    window.onload = () => {
        setGreeting();
        loadDashboardData();
    };
</script>

</body>
</html>